{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_ordemAtual","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","Bind","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","_service","NegociacaoService","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texto","erro","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","apaga","esvazia","coluna","inverteOrdem","ordena","a","b","Negociacao","DateHelper","textoParaData","value","parseInt","parseFloat","focus","importa","error"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["/**\nComunicacoes entre o usuario e o modelo\n**/\nclass NegociacaoController {\n\n\tconstructor() {\n\t\t\n\t\tlet $ = document.querySelector.bind(document);\n\n\t\tthis._ordemAtual = '';\n\t\tthis._inputData = $(\"#data\");\n\t\tthis._inputQuantidade = $(\"#quantidade\");\n\t\tthis._inputValor = $(\"#valor\");\n\n\t\tthis._listaNegociacoes = new Bind(\n\t\t\tnew ListaNegociacoes(), \n\t\t\tnew NegociacoesView($('#negociacoesView')), \n\t\t\t'adiciona', 'esvazia', 'ordena', 'inverteOrdem');\n\t\t\n\t\tthis._mensagem = new Bind(\n\t\t\tnew Mensagem(), \n\t\t\tnew MensagemView($('#mensagemView')),\n\t\t\t'texto');\n\n\t\tthis._service = new NegociacaoService();\n\n\t\tthis._init();\n\n\n\t}\n\n\t_init(){\n\n\t\tthis._service\n\t\t\t.lista()\n\t\t\t.then(negociacoes =>\n\t\t\t\t\tnegociacoes.forEach(negociacao => \n\t\t\t\t\t\tthis._listaNegociacoes.adiciona(negociacao)))\n\t\t\t.catch(erro => this._mensagem.texto = erro);\n\n\t\t\tsetInterval( () => {\n\t\t\t\tthis.importaNegociacoes();\n\t\t\t},3000);\n\n\t}\n\n\tadiciona(event){\n\n\t\tevent.preventDefault();\n\n\t\tlet negociacao = this._criaNegociacao();\n\n\t\tthis._service\n\t\t\t.cadastra(negociacao)\n\t\t\t.then(mensagem => {\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\n\t\t\t\tthis._mensagem.texto = mensagem;\n\t\t\t\tthis._limpaFormulario();\n\t\t\t}).catch(erro => this._mensagem.texto = erro);\n\n\n\t}\n\n\tapaga() {\n\n\t\tthis._service\n\t\t\t.apaga()\n\t\t\t.then( mensagem => {\n\t\t\t\t\tthis._listaNegociacoes.esvazia();\n\t\t\t\t\tthis._mensagem.texto = mensagem;\n\t\t\t})\n\t\t\t.catch(erro => this._mensagem.texto = erro );\n\n\n\t}\n\n\tordena(coluna) {\n\t\tif (this._ordemAtual == coluna)\n\t\t\tthis._listaNegociacoes.inverteOrdem();\n\t\telse\n\t\t\tthis._listaNegociacoes.ordena( (a,b) => a[coluna] - b[coluna]);\n\n\t\tthis._ordemAtual = coluna;\n\t}\n\n\t_criaNegociacao() {\n\t\treturn new Negociacao(\n\t\t\tDateHelper.textoParaData(this._inputData.value),\n\t\t\tparseInt(this._inputQuantidade.value),\n\t\t\tparseFloat(this._inputValor.value)\n\t\t\t);\n\t}\n\n\t_limpaFormulario() {\n\t\tthis._inputData.value = '';\n\t\tthis._inputQuantidade.value = 1;\n\t\tthis._inputValor.value = 0.0;\n\n\t\tthis._inputData.focus();\n\t}\n\n\timportaNegociacoes() {\n\n\t\tthis._service\n\t\t\t.importa(this._listaNegociacoes.negociacoes)\n\t\t\t.then(negociacoes => {\n\t\t\t\t\tnegociacoes\n\t\t\t\t\t.forEach(negociacao => this._listaNegociacoes.adiciona(negociacao));\n\t\t\t\t\tthis._mensagem.texto = \"Negociacoes importadas com sucesso!\";\n\t\t\t})\n\t\t\t.catch(error => this._mensagem.texto = error);\n\t}\n\n}"]}