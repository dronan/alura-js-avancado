{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["ListaNegociacoes","Bind","NegociacoesView","Mensagem","MensagemView","NegociacaoService","Negociacao","DateHelper","NegociacaoController","$","document","querySelector","bind","_ordemAtual","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","_mensagem","_service","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texto","erro","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","apaga","esvazia","coluna","inverteOrdem","ordena","a","b","textoParaData","value","parseInt","parseFloat","focus","importa","error","negociacaoController","currentInstance"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import {ListaNegociacoes} from '../models/ListaNegociacoes';\nimport {Bind} from '../helpers/Bind';\nimport {NegociacoesView} from '../views/NegociacoesView';\nimport {Mensagem} from '../models/Mensagem';\nimport {MensagemView} from '../views/MensagemView';\nimport {NegociacaoService} from '../services/NegociacaoService';\nimport {Negociacao} from '../models/Negociacao';\nimport {DateHelper} from '../helpers/DateHelper';\n\nclass NegociacaoController {\n\n\tconstructor() {\n\t\t\n\t\tlet $ = document.querySelector.bind(document);\n\n\t\tthis._ordemAtual = '';\n\t\tthis._inputData = $(\"#data\");\n\t\tthis._inputQuantidade = $(\"#quantidade\");\n\t\tthis._inputValor = $(\"#valor\");\n\n\t\tthis._listaNegociacoes = new Bind(\n\t\t\tnew ListaNegociacoes(), \n\t\t\tnew NegociacoesView($('#negociacoesView')), \n\t\t\t'adiciona', 'esvazia', 'ordena', 'inverteOrdem');\n\t\t\n\t\tthis._mensagem = new Bind(\n\t\t\tnew Mensagem(), \n\t\t\tnew MensagemView($('#mensagemView')),\n\t\t\t'texto');\n\n\t\tthis._service = new NegociacaoService();\n\n\t\tthis._init();\n\n\n\t}\n\n\t_init(){\n\n\t\tthis._service\n\t\t\t.lista()\n\t\t\t.then(negociacoes =>\n\t\t\t\t\tnegociacoes.forEach(negociacao => \n\t\t\t\t\t\tthis._listaNegociacoes.adiciona(negociacao)))\n\t\t\t.catch(erro => this._mensagem.texto = erro);\n\n\t\t\tsetInterval( () => {\n\t\t\t\tthis.importaNegociacoes();\n\t\t\t},3000);\n\n\t}\n\n\tadiciona(event){\n\n\t\tevent.preventDefault();\n\n\t\tlet negociacao = this._criaNegociacao();\n\n\t\tthis._service\n\t\t\t.cadastra(negociacao)\n\t\t\t.then(mensagem => {\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\n\t\t\t\tthis._mensagem.texto = mensagem;\n\t\t\t\tthis._limpaFormulario();\n\t\t\t}).catch(erro => this._mensagem.texto = erro);\n\n\n\t}\n\n\tapaga() {\n\n\t\tthis._service\n\t\t\t.apaga()\n\t\t\t.then( mensagem => {\n\t\t\t\t\tthis._listaNegociacoes.esvazia();\n\t\t\t\t\tthis._mensagem.texto = mensagem;\n\t\t\t})\n\t\t\t.catch(erro => this._mensagem.texto = erro );\n\n\n\t}\n\n\tordena(coluna) {\n\t\tif (this._ordemAtual == coluna)\n\t\t\tthis._listaNegociacoes.inverteOrdem();\n\t\telse\n\t\t\tthis._listaNegociacoes.ordena( (a,b) => a[coluna] - b[coluna]);\n\n\t\tthis._ordemAtual = coluna;\n\t}\n\n\t_criaNegociacao() {\n\t\treturn new Negociacao(\n\t\t\tDateHelper.textoParaData(this._inputData.value),\n\t\t\tparseInt(this._inputQuantidade.value),\n\t\t\tparseFloat(this._inputValor.value)\n\t\t\t);\n\t}\n\n\t_limpaFormulario() {\n\t\tthis._inputData.value = '';\n\t\tthis._inputQuantidade.value = 1;\n\t\tthis._inputValor.value = 0.0;\n\n\t\tthis._inputData.focus();\n\t}\n\n\timportaNegociacoes() {\n\n\t\tthis._service\n\t\t\t.importa(this._listaNegociacoes.negociacoes)\n\t\t\t.then(negociacoes => {\n\t\t\t\t\tnegociacoes\n\t\t\t\t\t.forEach(negociacao => this._listaNegociacoes.adiciona(negociacao));\n\t\t\t\t\tthis._mensagem.texto = \"Negociacoes importadas com sucesso!\";\n\t\t\t})\n\t\t\t.catch(error => this._mensagem.texto = error);\n\t}\n\n}\n\nlet negociacaoController = new NegociacaoController();\n\nexport function currentInstance() {\n\n    return negociacaoController;\n\n}\n"]}